🎬 Project: Streaming Platform with WatchPartyThe goal of this annual project is to create a web application for a streaming platform, similar to services like Netflix or HBO, but with the added value of a WatchParty feature.This document describes the architecture and features of both the backend (built in NestJS) and the frontend (built in React).✨ Technologies UsedHere is a detailed overview of the key libraries, frameworks, and services used in the project.🚀 Backend (NestJS)Framework: NestJS – A progressive Node.js framework for building efficient and scalable server-side applications.Language: TypeScript – A statically-typed language that builds on JavaScript, increasing code robustness.Database ORM: Prisma – A modern ORM for Node.js and TypeScript, used for database communication.Authentication:JSON Web Tokens (JWT) – For creating and verifying access tokens.Argon2 – A secure library for hashing and verifying passwords.Real-time Communication: Socket.io – For bi-directional, real-time communication (WatchParty) implemented via NestJS Gateways.File Storage: Supabase Storage – Used for cloud storage and delivery of user avatars.Streaming: FFmpeg – A tool called as a system process (spawn) for on-the-fly transcoding of video segments (to AAC audio).🖥️ Frontend (React)Framework: React – A library for building user interfaces.Bundler: Vite – A fast development and build tool for modern web applications.Language: TypeScript (with TSX) – For type safety in the frontend code.Styling: Tailwind CSS – A utility-first CSS framework for rapid design.UI Library: Shadcn UI – A collection of reusable UI components built on Tailwind and Radix UI.Routing: React Router – For navigation and page management within the SPA.State Management:Zustand – A minimalist library for global state management (used for userStore, modalStore).React Context – React's built-in mechanism for sharing data (used for user-context).Forms:React Hook Form – For efficient form state management.Zod – A library for form schema validation.HTTP Client: Axios – For sending HTTP requests to the backend API.Video Player: @vidstack/react – A modern video player library for React, used for HLS streaming.Utilities: clsx & tailwind-merge – Helper utilities (part of shadcn/ui) for conditionally merging Tailwind classes.🚀 Backend (NestJS)The backend provides a robust REST API and WebSocket server to manage the entire application.Key Backend Features🔐 Authentication & AuthorizationNew user registration.User login via email and password.Password security using the argon2 hashing algorithm.Protection of sensitive endpoints using AuthGuard and a JWT (JSON Web Tokens) strategy.👤 User ManagementAPI for fetching data of the logged-in user.Ability to update user data (username, email, password).Uploading and management of profile pictures (avatars) using Supabase Storage.🍿 Video StreamingAPI for fetching a list of videos, details of a specific video, and a random video (e.g., for the homepage banner).All video metadata is managed via the database using Prisma ORM.📺 Proxy & Transcoding (HLS)A custom proxy server for securely fetching streaming manifests (m3u8) and segments (.ts).Dynamic rewriting of URLs in m3u8 playlists to point to the transcoding endpoint.On-the-fly transcoding of video segments using ffmpeg. This ensures cross-browser compatibility by copying the video track and converting the audio track to AAC format.🎉 WatchParty (WebSocket Gateway)Implementation of a WebSocket server using NestJS Gateways and socket.io.Allows for creating and joining "rooms" (roomId).Ensures synchronization of the player state (play, pause, seek) in real-time among all participants in the room.📡 API Endpoints (Overview)ModuleMethodEndpointAuth GuardDescriptionAuthPOST/auth/register❌Register a new user.AuthPOST/auth/login❌Log in a user and get a JWT.AuthPOST/auth/logout✅Log out a user.UserGET/user/me/:id✅Get user data.UserPUT/user/update/:id✅Update user data.UserPOST/user/upload/:id✅Upload user avatar.VideoGET/video✅Get a list of videos.VideoGET/video/random❌Get a random video (for banner).VideoGET/video/:id❌Get details for video playback.VideoGET/video/data/:id✅Get video metadata (for modal).ProxyGET/api/m3u8❌Proxy for m3u8 playlist (rewrites URLs).ProxyGET/api/transcode❌Transcode a video segment using FFmpeg.🖥️ Frontend (React)The frontend is a modern SPA (Single Page Application) built with React and Vite. It handles all user interaction with the platform.Key Frontend Features🧭 Routing and NavigationUses react-router-dom for dynamic page navigation.Implements a PrivateRoute component to protect sensitive parts of the application (like /home) and redirect unauthenticated users to the login page.Main pages:/ (Login / Register)/home (Main page with video overview)/watch/:id (The video player itself)💾 State ManagementZustand (userStore): Used for global authentication state management (user ID, JWT token). Data is persistently stored in localStorage to maintain login sessions.React Context (user-context): Used to store public user profile data (username, avatar URL) in sessionStorage, allowing easy sharing across components.Zustand (socketStore): Manages the WebSocket connection state and registers listeners for incoming events.Zustand (useModal): A central store for opening and closing modals (video details, profile settings, WatchParty menu) and passing necessary data (e.g., videoId).💅 UI and ComponentsThe entire application is styled using Tailwind CSS.Uses pre-built, yet fully customizable, components from Shadcn UI (Dialog, Button, Input, Form, DropdownMenu, Separator, etc.).The application is divided into logical, reusable components:Navbar: Navigation bar with search and user menu.Banner: Large banner on the main page.VideoCard: Card for displaying individual videos in a list.VideoLists: Component responsible for rendering rows of videos with horizontal scrolling.📝 Forms and Validationreact-hook-form is used for all forms (login, register, profile update).Form schema validation is handled by the zod library.🔧 User SettingsThe ProfileSettings component (displayed in a modal) allows the user to change their username, email, password, and upload a new profile picture.Avatar uploading sends the file directly to the backend API using axios and FormData.▶️ Video PlayerThe @vidstack/react library is used for video playback, providing a robust foundation for HLS streaming.Custom controls (VideoControls) were created, including buttons for play/pause, seek forward/backward, volume control (with a popup slider), and fullscreen mode.
